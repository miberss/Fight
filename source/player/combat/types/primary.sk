function on_primary_attack(attacker: player, item: Item struct):
    set {_ctx} to a_attack_context({_attacker}, {_item}, ("primary"))
    process_stats({_ctx}, "pre_hit")
    shoot_ray({_ctx})
    stop if {_ctx}->victim is not set
    on_hit({_ctx})